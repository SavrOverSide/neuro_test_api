Запуск контейнера с поддержкой GPU (при наличии nvidia-docker):

docker run --gpus all -p 8000:8000 clip-api


Тестирование API:

Перейдите в браузере по адресу http://localhost:8000/docs для доступа к автоматически сгенерированной Swagger UI.


Или протестируйте с помощью cURL:

Добавление класса:

curl -X POST "http://localhost:8000/add_class" -H "Content-Type: application/json" -d '{"description": "описание класса"}'

Предсказание (после добавления хотя бы одного класса):


curl -X POST "http://localhost:8000/predict" -F "file=@/путь/к/изображению.jpg"


Процесс работы API:

Эндпоинт /add_class принимает описание класса, кодирует его с помощью CLIP в вектор и добавляет в FAISS-индекс, одновременно сохраняя исходное описание в списке.

Эндпоинт /predict принимает изображение, кодирует его в векторное представление, выполняет поиск по FAISS-индексу для нахождения ближайших по схожести классов, вычисляет softmax-вероятности и возвращает класс с наивысшей вероятностью.
